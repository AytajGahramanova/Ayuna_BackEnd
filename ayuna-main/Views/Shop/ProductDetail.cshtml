@{
	ViewData["Title"] = "ProductDetail";
	Layout = "~/Views/Shared/_Layout.cshtml";
}

@model ProductDetailVM
<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>Ayuna - Product-details</title>
	<link rel="icon" href="assets/images/logo-white.png" />
	<!-- bootstrap -->
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css"
		  rel="stylesheet"
		  integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB"
		  crossorigin="anonymous" />
	<!-- font awesome -->
	<link rel="stylesheet"
		  href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css"
		  integrity="sha512-2SwdPD6INVrV/lHTZbO2nodKhrnDdJK9/kg2XD1r9uGqPo1cUbujc+IYdlYdEErWNu69gVcYgdxlmVmzTWnetw=="
		  crossorigin="anonymous"
		  referrerpolicy="no-referrer" />
	<!-- swiper -->
	<link rel="stylesheet"
		  href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />
	<!-- Fancybox -->
	<link rel="stylesheet"
		  href='@("https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0/dist/fancybox/fancybox.css")' />


	<link rel="stylesheet" href="./assets/css/style.css" />
	<link rel="stylesheet" href="./assets/css/product-detail.css" />
</head>
<body>
	<!-- scroll top start -->
	<button class="page-scroll-button d-flex align-items-center justify-content-center">
		<i class="fa-solid fa-chevron-up"></i>
	</button>
	<!-- scroll top end -->
	<!-- breadcrumb start -->
	<section class="breadcrumb-section">
		<div class="breadcrumb">
			<a href="index.html">Home / </a>
			<a href="#">Product-details</a>
		</div>
		<div class="layer"></div>
	</section>
	<!-- breadcrumb end -->
	<!-- product-details start -->
	<div class="shop-wrapper mt-5">
		<div class="container-desc">
			<div class="row flex-column-reverse flex-lg-row">
				<div class="col-12 col-lg-6 mt-5 mt-lg-0">
					<div style="
                --swiper-navigation-color: #fff;
                --swiper-pagination-color: #fff;
              "
						 class="swiper detailSwiper2">
						<div class="swiper-wrapper">
							<div class="swiper-slide">
								<img src="@Model.product.Image" alt="img" />
							</div>
							<div class="swiper-slide">
								<img src="@Model.product.ImageOne" alt="img" />
							</div>
							<div class="swiper-slide">
								<img src="@Model.product.ImageTwo" alt="img" />
							</div>
							<div class="swiper-slide">
								<img src="@Model.product.ImageThree" alt="img" />
							</div>
						</div>
						<div class="swiper-button-next"></div>
						<div class="swiper-button-prev"></div>
					</div>
					<div thumbsSlider="" class="swiper detailSwiper">
						<div class="swiper-wrapper">
							<div class="swiper-slide">
								<img src="@Model.product.Image" alt="img" />
							</div>
							<div class="swiper-slide">
								<img src="@Model.product.ImageOne" alt="img" />
							</div>
							<div class="swiper-slide">
								<img src="@Model.product.ImageTwo" alt="img" />
							</div>
							<div class="swiper-slide">
								<img src="@Model.product.ImageThree" alt="img" />
							</div>
						</div>
					</div>
				</div>
				<div class="col-12 col-lg-6">
					<div class="product-content d-flex flex-column gap-2">
						<div>
							<h3 class="name">@Model.product.Name</h3>
							@foreach (var item in Model.product.Categories)
							{
								<p class="categorie mb-0">@item.Name</p>
							}
							
						</div>
						<div>
							<span class="price">@Model.product.Price ₼</span>
							<h5 class="about mt-4">
								@Model.product.Description
							</h5>
						</div>
					</div>
					<div class="d-flex flex-column flex-lg-row align-items-start gap-3 mt-4 align-items-lg-center justify-content-between">
						<div class="quantity-buttons">
							<button class="decrement">-</button>
							<input disabled value="1" class="counter" />
							<button class="increment">+</button>
						</div>
						<div class="d-flex align-items-center gap-2">
							<div class="add-cart">
								<button>Add to cart</button>
							</div>
							<form class="add-wishlist" asp-controller="Wishlist" asp-action="Add" method="post">
								<input type="hidden" name="productId" value="@Model.product.Id" />
								<button style="border: none; background-color: transparent; position: relative" type="submit">
									<i style="color: @(Model.product.isLike == false ? "" : "#FF0000"); top:-9px; right:-13px;" class="@(Model.product.isLike == false ? "fa-regular fa-heart" : "fas fa-heart")"></i>
								</button>
							</form>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<!--product-details end -->
	<!-- testimonial section start -->
	<section class="testimonials-section">
		<h2 class="section-title">Müşteri Yorumları</h2>

		<div class="container-desc testimonials-container">
			@foreach (var item in Model.testimonials)
			{
				<div class="testimonial-card">
					<div class="rating">
						@for (int i = 1; i <= 5; i++)
						{
							if (i <= item.Star)
							{
								<i class="fas fa-star text-warning"></i>

							}
							else
							{
								<i class="far fa-star text-warning"></i>

							}
						}
					</div>

					<p class="testimonial-text">
						"@item.Comment"
					</p>
					<div class="user-info">
						<div class="user-avatar">AH</div>
						<div class="user-details">
							<div class="user-name">@item.UserName</div>
							<div class="user-location">@item.Location</div>
							<div class="time-ago">@item.dateTime</div>
						</div>
					</div>
				</div>
			}

		</div>
	</section>
	<!-- testimonial section end -->
	<!-- product info start -->
	<div class="product-info mb-5 mt-5">
		<!-- Nav tabs -->
		<ul class="product-tabs nav nav-tabs d-flex align-items-center justify-content-center gap-5"
			id="myTab"
			role="tablist">
			@* <li class="nav-item" role="presentation">
				<button class="nav-link active"
						id="home-tab"
						data-bs-toggle="tab"
						data-bs-target="#home"
						type="button"
						role="tab"
						aria-controls="home"
						aria-selected="true">
					Description
				</button>
			</li> *@
			<li class="nav-item" role="presentation">
				<button class="nav-link active"
						id="profile-tab"
						data-bs-toggle="tab"
						data-bs-target="#profile"
						type="button"
						role="tab"
						aria-controls="profile"
						aria-selected="false">
					Review
				</button>
			</li>
		</ul>

		<!-- Tab panes -->
		<div class="tab-content d-flex align-items-center p-3">
			@* <div class="tab-pane active"
				 id="home"
				 role="tabpanel"
				 aria-labelledby="home-tab"
				 tabindex="0">
				<div class="container-desc d-flex justify-content-between gap-3 gap-lg-5 flex-column flex-lg-row">
					<div>
						<h3>About design</h3>
						<p class="mb-2">
							Lorem Ipsum estibulum blandit libero at mauris condimentum
							scelerisque. In scelerisque in mauris ut malesuada. Nam sodales
							scelerisque ipsum sed vestibulum. Aliquam euismod mi vitae nibh
							placerat.
						</p>
						<p>
							Ut venenatis iaculis iaculis. Integer sit amet auctor justo, ac
							vestibulum orci. Aenean ultrices magna at porttitor eleifend.
						</p>
					</div>
					<div>
						<h3>Summer Collection</h3>
						<p>
							Lorem Ipsum estibulum blandit libero at mauris condimentum
							scelerisque. In scelerisque in mauris ut malesuada. Nam sodales
							scelerisque ipsum sed vestib.
						</p>
					</div>
				</div>
			</div> *@
			<div class="tab-pane w-100 active"
				 id="profile"
				 role="tabpanel"
				 aria-labelledby="profile-tab"
				 tabindex="0">
				<div class="container-desc">
					<form asp-controller="Home" asp-action="CommentCreate">
						<div class="rating" data-product-id="@Model.product.Id">
							<p>Your Rating</p>
							<i data-value="1" class="fa-regular fa-star star"></i>
							<i data-value="2" class="fa-regular fa-star star"></i>
							<i data-value="3" class="fa-regular fa-star star"></i>
							<i data-value="4" class="fa-regular fa-star star"></i>
							<i data-value="5" class="fa-regular fa-star star"></i>
						</div>

						<input type="hidden" id="ratingInput" name="rating" />
						<input type="hidden" name="proId" value="@Model.product.Id" />

						<textarea asp-for="@Model.testimonial.Comment" class="mb-4"></textarea>
						<div class="d-flex flex-column gap-5">
							<input asp-for="@Model.testimonial.UserName" placeholder="Your name" />
							<input asp-for="@Model.testimonial.Location" placeholder="Your location" />
						</div>
						<button class="mt-5" type="submit">
							<span>Submit</span>
						</button>
					</form>

				</div>
			</div>
		</div>
		<!-- product info end-->
	</div>

	<!-- related product start-->
	<section class="product-section">
		<div class="title text-center mb-4">
			<h3>Realted Products</h3>
		</div>
		<div class="container-desc d-flex flex-wrap flex-column">
			<div class="row d-flex justify-content-center justify-content-lg-between">
				@foreach (var item in Model.products.OrderByDescending(x => x.Id).Take(4))
				{
					<div class="product col-12 col-lg-3">
						<div class="product-image">
							<img src="@item.Image" alt="img" />
						</div>
						<div class="content">
							<div class="d-flex justify-content-between align-items-center position-relative">
								<a asp-route-id="@item.Id" asp-action="ProductDetail">@item.Name</a>
								<form asp-controller="Wishlist" asp-action="Add" method="post">
									<input type="hidden" name="productId" value="@item.Id" />
									<button style="border: none; background-color: transparent;" type="submit"><i style="color: @(item.isLike == false ? "" : "#FF0000")" class="@(item.isLike == false ? "fa-regular fa-heart" : "fas fa-heart")"></i></button>
								</form>
							</div>
							<div class="categorie">
								@foreach (var pro in Model.product.Categories)
								{
									<h5>@pro.Name</h5>
								}

							</div>
							<div class="price">
								<p>@item.Price ₼</p>
							</div>
						</div>
						<div class="hover-image">
							<img src="@item.hoverImage" alt="img" />
						</div>
						<div class="more-detail">
							<a asp-route-id="@item.Id" asp-action="ProductDetail">Select options</a>
						</div>
					</div>
				}

			</div>
		</div>
	</section>
	<!-- related product end-->
	<!-- bootstrap -->
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"
			integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI"
			crossorigin="anonymous"></script>
	<!-- font awesome -->
	<script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/js/all.min.js"
			integrity="sha512-gBYquPLlR76UWqCwD06/xwal4so02RjIR0oyG1TIhSGwmBTRrIkQbaPehPF8iwuY9jFikDHMGEelt0DtY7jtvQ=="
			crossorigin="anonymous"
			referrerpolicy="no-referrer"></script>
	<!-- swiper -->
	<script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
	<!-- fancybox js -->
	<script src='@("https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0/dist/fancybox/fancybox.umd.js")'></script>

	<script src="assets/script.js"></script>
	<script>
		var swiper = new Swiper(".detailSwiper", {
		  loop: true,
		  spaceBetween: 10,
		  slidesPerView: 4,
		  freeMode: true,
		  watchSlidesProgress: true,
		});
		var swiper2 = new Swiper(".detailSwiper2", {
		  loop: true,
		  spaceBetween: 10,
		  navigation: {
			nextEl: ".swiper-button-next",
			prevEl: ".swiper-button-prev",
		  },
		  thumbs: {
			swiper: swiper,
		  },
		});
	</script>
	<script>
		const quantityWrappers = document.querySelectorAll(".quantity-buttons");

		quantityWrappers.forEach((wrapper) => {
		  const decrementBtn = wrapper.querySelector(".decrement");
		  const incrementBtn = wrapper.querySelector(".increment");
		  const input = wrapper.querySelector(".counter");

		  decrementBtn.addEventListener("click", () => {
			let value = parseInt(input.value);
			if (value > 1) {
			  input.value = value - 1;
			}
		  });

		  incrementBtn.addEventListener("click", () => {
			let value = parseInt(input.value);
			input.value = value + 1;
		  });
		});
	</script>
	@* <script>
			document.addEventListener("DOMContentLoaded", function () {
			const ratingBox = document.querySelector('.rating');
			const productId = ratingBox.getAttribute('data-product-id');
			const stars = Array.from(document.querySelectorAll('.rating .star'));

			function setStars(value) {
				stars.forEach((s, i) => {
					if (i < value) {
						s.classList.add('fa-solid');
						s.classList.remove('fa-regular');
					} else {
						s.classList.add('fa-regular');
						s.classList.remove('fa-solid');
					}
				});
			}

			stars.forEach(star => {
				star.addEventListener('click', function () {
					const value = Number(star.getAttribute('data-value'));
					setStars(value);

					fetch('/Rating/Rate', {
						method: 'POST',
						headers: {
							'Content-Type': 'application/json'
						},
						body: JSON.stringify({ productId: productId, rating: value })
					});
				});
			});
		});



	</script> *@

	<script>
		document.addEventListener("DOMContentLoaded", function () {
			const ratingBox = document.querySelector('.rating');
			const productId = ratingBox.dataset.productId;
			const stars = Array.from(document.querySelectorAll('.rating .star'));
			const ratingInput = document.querySelector("#ratingInput");

			// Ulduzları boyayan funksiya
			function setStars(value) {
				stars.forEach((s, i) => {
					s.classList.toggle('fa-solid', i < value);
					s.classList.toggle('fa-regular', i >= value);
				});
			}

			// Click event
			stars.forEach(star => {
				star.addEventListener("click", function () {
					const value = Number(this.dataset.value);

					// Ulduzların vizual dəyişməsi
					setStars(value);

					// Hidden input-a yazırıq (form submit olsa controllerə gedir)
					ratingInput.value = value;

					// AJAX ilə də göndərmək istəyirsənsə:
					fetch('/Rating/Rate', {
						method: 'POST',
						headers: { 'Content-Type': 'application/json' },
						body: JSON.stringify({ productId: productId, rating: value })
					})
					.then(res => res.json())
					.then(data => {
						console.log("Server response:", data);
					});
				});
			});

		});
	</script>



</body>
</html>